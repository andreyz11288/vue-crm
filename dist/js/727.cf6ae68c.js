"use strict";(self["webpackChunkcrm"]=self["webpackChunkcrm"]||[]).push([[727],{4727:function(e,i,l){l.r(i),l.d(i,{default:function(){return D}});var a=l(3396),t=l(7139),s=l(9242);const n=e=>((0,a.dD)("data-v-134b27c0"),e=e(),(0,a.Cn)(),e),c={class:"page-title"},r={class:"input-field"},o={for:"name"},u={key:0,class:"helper-text invalid"},d={class:"input-field"},m={for:"email"},h={key:0,class:"input-field"},p={class:"label-pass",for:"pass"},f={class:"input-field"},w=["value"],v={for:"select"},y={class:"switch"},_=n((()=>(0,a._)("span",{class:"lever"},null,-1))),z={class:"btn waves-effect waves-light",type:"submit"},E=n((()=>(0,a._)("i",{class:"material-icons right"},"send",-1)));function $(e,i,l,n,$,U){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",c,[(0,a._)("h3",null,(0,t.zw)(e.$filters.localize.localizeFilter("Profile")),1)]),(0,a._)("form",{class:"form",onSubmit:i[6]||(i[6]=(0,s.iM)(((...e)=>U.handleSubmit&&U.handleSubmit(...e)),["prevent"]))},[(0,a._)("div",r,[(0,a.wy)((0,a._)("input",{id:"name",type:"text","onUpdate:modelValue":i[0]||(i[0]=i=>e.name=i),class:(0,t.C_)({invalid:e.v$.name.$dirty&&e.v$.name.required.$invalid})},null,2),[[s.nr,e.name]]),(0,a._)("label",o,(0,t.zw)(e.$filters.localize.localizeFilter("Name")),1),e.v$.name.$dirty&&e.v$.name.required.$invalid?((0,a.wg)(),(0,a.iD)("span",u,(0,t.zw)(e.$filters.localize.localizeFilter("Enter your name")),1)):(0,a.kq)("",!0)]),(0,a._)("div",d,[(0,a.wy)((0,a._)("input",{id:"email",type:"text","onUpdate:modelValue":i[1]||(i[1]=i=>e.newEmail=i),onInput:i[2]||(i[2]=(...e)=>U.inputContext&&U.inputContext(...e))},null,544),[[s.nr,e.newEmail]]),(0,a._)("label",m,(0,t.zw)(e.$filters.localize.localizeFilter("Change Email")),1)]),e.changedEmail?((0,a.wg)(),(0,a.iD)("div",h,[(0,a.wy)((0,a._)("input",{id:"pass",type:"text","onUpdate:modelValue":i[3]||(i[3]=i=>e.pass=i)},null,512),[[s.nr,e.pass]]),(0,a._)("label",p,(0,t.zw)(e.$filters.localize.localizeFilter("Enter password for change Email")),1)])):(0,a.kq)("",!0),(0,a._)("div",f,[(0,a.wy)((0,a._)("select",{ref:"select","onUpdate:modelValue":i[4]||(i[4]=i=>e.currency=i)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.currencies,((e,i)=>((0,a.wg)(),(0,a.iD)("option",{key:i,value:e},(0,t.zw)(e),9,w)))),128))],512),[[s.bM,e.currency]]),(0,a._)("label",v,(0,t.zw)(e.$filters.localize.localizeFilter("Select a currency")),1)]),(0,a._)("div",y,[(0,a._)("label",null,[(0,a.Uk)(" English "),(0,a.wy)((0,a._)("input",{type:"checkbox","onUpdate:modelValue":i[5]||(i[5]=i=>e.isUaLocale=i)},null,512),[[s.e8,e.isUaLocale]]),_,(0,a.Uk)(" Українська ")])]),(0,a._)("button",z,[(0,a.Uk)((0,t.zw)(e.$filters.localize.localizeFilter("Update"))+" ",1),E])],32)])}var U=l(65),b=l(5420),g=l(4219),k=l(2524),F=l(6530),x={setup:()=>((0,F.u)({title:(0,a.Fl)((()=>k.Z.localizeFilter("Profile")))}),{v$:(0,g.Xw)()}),data:()=>({select:null,name:"",currency:null,isUaLocale:!0,currencies:[],newEmail:"",pass:"",changedEmail:!1}),validations:{name:{required:b.C1},currency:{required:b.C1}},async mounted(){this.newEmail=await this.$store.dispatch("fetchEmail"),this.currencies=["UAH","USD","EUR"],this.name=this.info.name,this.currency=this.info.currency,this.isUaLocale="uk_UA"===this.info.locale,setTimeout((()=>{this.select=M.FormSelect.init(this.$refs.select),M.updateTextFields()}),0)},computed:{...(0,U.Se)(["info"])},methods:{localizeFilter:k.Z,...(0,U.nv)(["updateInfo","fetchEmail","updateEmail","fetchAllUsers"]),async inputContext(e){this.changedEmail=await this.fetchEmail()!==this.newEmail},async handleSubmit(){if(this.v$.$invalid)return void this.v$.$touch();const e={name:this.name,currency:this.currency,locale:this.isUaLocale?"uk_UA":"en_US"};try{const i=(await this.fetchAllUsers()).find((e=>e.info.email===this.newEmail)),l={email:this.newEmail,router:this.$router,pass:this.pass};if(await this.fetchEmail()!==this.newEmail){if(i)return void M.toast({html:k.Z.localizeFilter("This email already exists")});await this.updateEmail(l)}await this.updateInfo(e)}catch(i){console.log(i)}}}},C=l(89);const S=(0,C.Z)(x,[["render",$],["__scopeId","data-v-134b27c0"]]);var D=S}}]);
//# sourceMappingURL=727.cf6ae68c.js.map