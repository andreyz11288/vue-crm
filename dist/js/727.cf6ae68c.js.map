{"version":3,"file":"js/727.cf6ae68c.js","mappings":"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","sources":["webpack://crm/./src/views/Profile.vue","webpack://crm/./src/views/Profile.vue?24e8"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"page-title\">\r\n      <h3>{{ $filters.localize.localizeFilter('Profile') }}</h3>\r\n    </div>\r\n\r\n    <form class=\"form\" @submit.prevent=\"handleSubmit\">\r\n      <div class=\"input-field\">\r\n        <input\r\n            id=\"name\"\r\n            type=\"text\"\r\n            v-model=\"name\"\r\n            :class=\"{invalid: (v$.name.$dirty && v$.name.required.$invalid)}\"\r\n        >\r\n        <label for=\"name\">{{ $filters.localize.localizeFilter('Name') }}</label>\r\n        <span\r\n            class=\"helper-text invalid\"\r\n            v-if=\"v$.name.$dirty && v$.name.required.$invalid\">{{ $filters.localize.localizeFilter('Enter your name') }}</span>\r\n      </div>\r\n      <div class=\"input-field\">\r\n        <input\r\n            id=\"email\"\r\n            type=\"text\"\r\n            v-model=\"newEmail\"\r\n            @input=\"inputContext\"\r\n        >\r\n        <label for=\"email\">{{ $filters.localize.localizeFilter('Change Email') }}</label>\r\n      </div>\r\n      <div class=\"input-field\" v-if=\"changedEmail\">\r\n        <input\r\n            id=\"pass\"\r\n            type=\"text\"\r\n            v-model=\"pass\"\r\n        >\r\n        <label class=\"label-pass\"\r\n               for=\"pass\">{{ $filters.localize.localizeFilter('Enter password for change Email') }}</label>\r\n      </div>\r\n      <div class=\"input-field\">\r\n        <select ref=\"select\" v-model=\"currency\">\r\n          <option\r\n              v-for=\"(c, idx) in currencies\"\r\n              :key=\"idx\"\r\n              :value=\"c\"\r\n          >\r\n            {{ c }}\r\n          </option>\r\n        </select>\r\n        <label for=\"select\">{{ $filters.localize.localizeFilter('Select a currency') }}</label>\r\n      </div>\r\n      <div class=\"switch\">\r\n        <label>\r\n          English\r\n          <input type=\"checkbox\" v-model=\"isUaLocale\">\r\n          <span class=\"lever\"></span>\r\n          Українська\r\n        </label>\r\n      </div>\r\n\r\n      <button class=\"btn waves-effect waves-light\" type=\"submit\">\r\n        {{ $filters.localize.localizeFilter('Update') }}\r\n        <i class=\"material-icons right\">send</i>\r\n      </button>\r\n    </form>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {mapGetters, mapActions} from 'vuex'\r\nimport {required} from '@vuelidate/validators'\r\nimport {useVuelidate} from \"@vuelidate/core\";\r\nimport localizeFilter from \"@/filter/localize.filter\";\r\nimport {computed} from \"vue\";\r\nimport {useHead} from \"@vueuse/head\";\r\n\r\nexport default {\r\n  setup: () => (\r\n      useHead({\r\n        title: computed(() => localizeFilter.localizeFilter('Profile'))\r\n      }),\r\n          {\r\n            v$: useVuelidate()\r\n          }\r\n  ),\r\n  data: () => ({\r\n    select: null,\r\n    name: '',\r\n    currency: null,\r\n    isUaLocale: true,\r\n    currencies: [],\r\n    newEmail: '',\r\n    pass: '',\r\n    changedEmail: false,\r\n  }),\r\n  validations: {\r\n    name: {\r\n      required\r\n    },\r\n    currency: {\r\n      required\r\n    }\r\n  },\r\n  async mounted() {\r\n    this.newEmail = await this.$store.dispatch('fetchEmail')\r\n    this.currencies = ['UAH', 'USD', 'EUR']\r\n    this.name = this.info.name\r\n    this.currency = this.info.currency\r\n    this.isUaLocale = this.info.locale === 'uk_UA'\r\n    setTimeout(() => {\r\n      this.select = M.FormSelect.init(this.$refs.select);\r\n      M.updateTextFields()\r\n    }, 0)\r\n  },\r\n  computed: {\r\n    ...mapGetters(['info'])\r\n  },\r\n  methods: {\r\n    localizeFilter,\r\n    ...mapActions(['updateInfo', 'fetchEmail', 'updateEmail', 'fetchAllUsers']),\r\n\r\n    async inputContext(e) {\r\n      this.changedEmail = await this.fetchEmail() !== this.newEmail;\r\n    },\r\n\r\n    async handleSubmit() {\r\n      if (this.v$.$invalid) {\r\n        this.v$.$touch()\r\n        return\r\n      }\r\n      const formData = {\r\n        name: this.name,\r\n        currency: this.currency,\r\n        locale: this.isUaLocale ? 'uk_UA' : 'en_US',\r\n      }\r\n      try {\r\n        const emailExists = (await this.fetchAllUsers()).find(user =>\r\n            user.info.email === this.newEmail\r\n        )\r\n        const data = {\r\n          email: this.newEmail,\r\n          router: this.$router,\r\n          pass: this.pass\r\n        }\r\n        if (await this.fetchEmail() !== this.newEmail) {\r\n\r\n          if (emailExists) {\r\n            M.toast({html: localizeFilter.localizeFilter('This email already exists')})\r\n            return\r\n          }\r\n\r\n          await this.updateEmail(data)\r\n        }\r\n        await this.updateInfo(formData)\r\n\r\n      } catch (e) {\r\n        console.log(e)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n\r\n<style scoped lang=\"scss\">\r\n.switch {\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.label-pass {\r\n  color: red;\r\n}\r\n\r\n</style>","import { render } from \"./Profile.vue?vue&type=template&id=134b27c0&scoped=true\"\nimport script from \"./Profile.vue?vue&type=script&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&lang=js\"\n\nimport \"./Profile.vue?vue&type=style&index=0&id=134b27c0&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-134b27c0\"]])\n\nexport default __exports__"],"names":["class","for","_createElementVNode","type","_createElementBlock","_hoisted_1","_toDisplayString","_ctx","$filters","localize","localizeFilter","onSubmit","_cache","_withModifiers","args","$options","handleSubmit","_hoisted_2","id","name","$event","_normalizeClass","invalid","v$","$dirty","required","$invalid","_hoisted_3","_hoisted_4","_hoisted_5","newEmail","onInput","inputContext","_hoisted_6","changedEmail","_hoisted_7","pass","_hoisted_8","_hoisted_9","ref","currency","_Fragment","_renderList","currencies","c","idx","key","value","_hoisted_10","_hoisted_11","_hoisted_12","isUaLocale","_hoisted_13","_hoisted_14","_hoisted_15","setup","useHead","title","computed","useVuelidate","data","select","validations","mounted","this","$store","dispatch","info","locale","setTimeout","M","FormSelect","init","$refs","updateTextFields","mapGetters","methods","mapActions","e","fetchEmail","$touch","formData","emailExists","fetchAllUsers","find","user","email","router","$router","toast","html","updateEmail","updateInfo","console","log","__exports__","render"],"sourceRoot":""}