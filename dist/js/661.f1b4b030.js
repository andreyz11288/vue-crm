"use strict";(self["webpackChunkcrm"]=self["webpackChunkcrm"]||[]).push([[661],{9661:function(e,t,i){i.r(t),i.d(t,{default:function(){return C}});var l=i(3396),a=i(7139),s=i(9242);const n={class:"page-title"},o={key:1,class:"center"},c={class:"input-field"},r=["value"],d={class:"input-field"},u={for:"amount"},p={key:0,class:"helper-text invalid"},m={class:"input-field"},h={for:"description"},y={key:0,class:"helper-text invalid"},f={class:"btn waves-effect waves-light",type:"submit"},v=(0,l._)("i",{class:"material-icons right"},"send",-1);function $(e,t,i,$,w,z){const g=(0,l.up)("Loader"),_=(0,l.up)("router-link");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",n,[(0,l._)("h3",null,(0,a.zw)(e.$filters.localize.localizeFilter("New entry")),1)]),e.loading?((0,l.wg)(),(0,l.j4)(g,{key:0})):e.categories.length?((0,l.wg)(),(0,l.iD)("form",{key:2,class:"form",onSubmit:t[5]||(t[5]=(0,s.iM)(((...e)=>z.handleSubmit&&z.handleSubmit(...e)),["prevent"]))},[(0,l._)("div",c,[(0,l.wy)((0,l._)("select",{ref:"select","onUpdate:modelValue":t[0]||(t[0]=t=>e.category=t)},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.categories,(e=>((0,l.wg)(),(0,l.iD)("option",{key:e.id,value:e.id},(0,a.zw)(e.title),9,r)))),128))],512),[[s.bM,e.category]]),(0,l._)("label",null,(0,a.zw)(e.$filters.localize.localizeFilter("Add a new category")),1)]),(0,l._)("p",null,[(0,l._)("label",null,[(0,l.wy)((0,l._)("input",{class:"with-gap",name:"type",type:"radio",value:"income","onUpdate:modelValue":t[1]||(t[1]=t=>e.type=t)},null,512),[[s.G2,e.type]]),(0,l._)("span",null,(0,a.zw)(e.$filters.localize.localizeFilter("Income")),1)])]),(0,l._)("p",null,[(0,l._)("label",null,[(0,l.wy)((0,l._)("input",{class:"with-gap",name:"type",type:"radio",value:"outcome","onUpdate:modelValue":t[2]||(t[2]=t=>e.type=t)},null,512),[[s.G2,e.type]]),(0,l._)("span",null,(0,a.zw)(e.$filters.localize.localizeFilter("Outcome")),1)])]),(0,l._)("div",d,[(0,l.wy)((0,l._)("input",{id:"amount",type:"number","onUpdate:modelValue":t[3]||(t[3]=t=>e.amount=t),class:(0,a.C_)({invalid:e.v$.amount.$dirty&&e.v$.amount.minValue.$invalid})},null,2),[[s.nr,e.amount,void 0,{number:!0}]]),(0,l._)("label",u,(0,a.zw)(e.$filters.localize.localizeFilter("Sum")),1),e.v$.amount.$dirty&&e.v$.amount.minValue.$invalid?((0,l.wg)(),(0,l.iD)("span",p,(0,a.zw)(e.$filters.localize.localizeFilter("Minimum value"))+" "+(0,a.zw)(e.v$.amount.minValue.$params.min),1)):(0,l.kq)("",!0)]),(0,l._)("div",m,[(0,l.wy)((0,l._)("input",{id:"description",type:"text","onUpdate:modelValue":t[4]||(t[4]=t=>e.description=t),class:(0,a.C_)({invalid:e.v$.description.$dirty&&e.v$.description.required.$invalid})},null,2),[[s.nr,e.description]]),(0,l._)("label",h,(0,a.zw)(e.$filters.localize.localizeFilter("Description")),1),e.v$.description.$dirty&&e.v$.description.required.$invalid?((0,l.wg)(),(0,l.iD)("span",y,(0,a.zw)(e.$filters.localize.localizeFilter("Enter a description")),1)):(0,l.kq)("",!0)]),(0,l._)("button",f,[(0,l.Uk)((0,a.zw)(e.$filters.localize.localizeFilter("Create"))+" ",1),v])],32)):((0,l.wg)(),(0,l.iD)("p",o,[(0,l.Uk)((0,a.zw)(e.$filters.localize.localizeFilter("No categories yet"))+". ",1),(0,l.Wm)(_,{to:"/categories"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$filters.localize.localizeFilter("Add a new category")),1)])),_:1})]))])}var w=i(141),z=i(4219),g=i(5420),_=i(65),b={name:"record",setup:()=>({v$:(0,z.Xw)()}),components:{Loader:w.Z},data:()=>({loading:!0,categories:[],category:null,type:"income",amount:1,description:""}),async mounted(){this.categories=await this.$store.dispatch("fetchCategories"),this.loading=!1,this.categories.length&&(this.category=this.categories[0].id),setTimeout((()=>{this.select=M.FormSelect.init(this.$refs.select),M.updateTextFields()}),0)},validations:{description:{required:g.C1},amount:{minValue:(0,g.uv)(1)}},computed:{...(0,_.Se)(["info"]),canCreateRecord(){return"income"===this.type||this.info.bill>=this.amount}},methods:{async handleSubmit(){if(this.v$.$invalid)this.v$.$touch();else if(this.canCreateRecord)try{await this.$store.dispatch("createRecord",{categoryId:this.category,amount:this.amount,description:this.description,type:this.type,date:(new Date).toJSON()});const e="income"===this.type?this.info.bill+this.amount:this.info.bill-this.amount;await this.$store.dispatch("updateInfo",{bill:e}),M.toast({html:this.$filters.localize.localizeFilter("Entry created successfully")}),this.v$.$reset(),this.amount=1,this.description=""}catch(e){console.log(e)}else M.toast({html:`${this.$filters.localize.localizeFilter("Insufficient funds in the account")} ${this.amount-this.info.bill}`})}},deactivated(){this.select&&this.select.deactivated&&this.select.deactivated()}},k=i(89);const F=(0,k.Z)(b,[["render",$]]);var C=F}}]);
//# sourceMappingURL=661.f1b4b030.js.map