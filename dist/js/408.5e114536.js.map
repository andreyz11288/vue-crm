{"version":3,"file":"js/408.5e114536.js","mappings":"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","sources":["webpack://crm/./src/views/Profile.vue","webpack://crm/./src/views/Profile.vue?24e8"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"page-title\">\r\n      <h3>{{ $filters.localize.localizeFilter('Profile') }}</h3>\r\n    </div>\r\n\r\n    <form class=\"form\" @submit.prevent=\"handleSubmit\">\r\n      <div class=\"input-field\">\r\n        <input\r\n            id=\"name\"\r\n            type=\"text\"\r\n            v-model=\"name\"\r\n            :class=\"{invalid: (v$.name.$dirty && v$.name.required.$invalid)}\"\r\n        >\r\n        <label for=\"name\">{{ $filters.localize.localizeFilter('Name') }}</label>\r\n        <span\r\n            class=\"helper-text invalid\"\r\n            v-if=\"v$.name.$dirty && v$.name.required.$invalid\">{{ $filters.localize.localizeFilter('Enter your name') }}</span>\r\n      </div>\r\n      <div class=\"input-field\">\r\n        <input\r\n            id=\"email\"\r\n            type=\"text\"\r\n            v-model=\"newEmail\"\r\n            @input=\"inputContext\"\r\n        >\r\n        <label for=\"email\">{{ $filters.localize.localizeFilter('Change Email') }}</label>\r\n      </div>\r\n      <div class=\"input-field\">\r\n        <input\r\n            @input=\"inputContextPass\"\r\n            id=\"password\"\r\n            type=\"password\"\r\n            v-model.trim=\"password\"\r\n            :class=\"{invalid: (v$.password.$dirty && v$.password.minLength.$invalid)}\"\r\n        >\r\n        <label for=\"password\">{{$filters.localize.localizeFilter('Enter new password')}}</label>\r\n        <small\r\n            class=\"helper-text invalid\"\r\n            v-if=\"v$.password.$dirty && v$.password.minLength.$invalid\"\r\n        >\r\n          {{$filters.localize.localizeFilter('The password must be')}} {{v$.password.minLength.$params.min}} {{$filters.localize.localizeFilter('characters. Now he')}} {{password.length}}\r\n        </small>\r\n      </div>\r\n      <div class=\"input-field\" v-if=\"changedEmailAndPassword\">\r\n        <input\r\n            id=\"pass\"\r\n            type=\"text\"\r\n            v-model=\"pass\"\r\n        >\r\n        <label class=\"label-pass\"\r\n               for=\"pass\">{{ $filters.localize.localizeFilter('Enter password for change Email or Password') }}</label>\r\n      </div>\r\n      <div class=\"input-field\">\r\n        <select ref=\"select\" v-model=\"currency\">\r\n          <option\r\n              v-for=\"(c, idx) in currencies\"\r\n              :key=\"idx\"\r\n              :value=\"c\"\r\n          >\r\n            {{ c }}\r\n          </option>\r\n        </select>\r\n        <label for=\"select\">{{ $filters.localize.localizeFilter('Select a currency') }}</label>\r\n      </div>\r\n      <div class=\"switch\">\r\n        <label>\r\n          English\r\n          <input type=\"checkbox\" v-model=\"isUaLocale\">\r\n          <span class=\"lever\"></span>\r\n          Українська\r\n        </label>\r\n      </div>\r\n\r\n      <button class=\"btn waves-effect waves-light\" type=\"submit\">\r\n        {{ $filters.localize.localizeFilter('Update') }}\r\n        <i class=\"material-icons right\">send</i>\r\n      </button>\r\n    </form>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {mapGetters, mapActions} from 'vuex'\r\nimport {required, minLength} from '@vuelidate/validators'\r\nimport {useVuelidate} from \"@vuelidate/core\";\r\nimport localizeFilter from \"@/filter/localize.filter\";\r\nimport {computed} from \"vue\";\r\nimport {useHead} from \"@vueuse/head\";\r\n\r\nexport default {\r\n  setup: () => (\r\n      useHead({\r\n        title: computed(() => localizeFilter.localizeFilter('Profile'))\r\n      }),\r\n          {\r\n            v$: useVuelidate()\r\n          }\r\n  ),\r\n  data: () => ({\r\n    select: null,\r\n    name: '',\r\n    currency: null,\r\n    isUaLocale: true,\r\n    currencies: [],\r\n    newEmail: '',\r\n    pass: '',\r\n    changedEmailAndPassword: false,\r\n    checkboxButton: false,\r\n    password: '',\r\n  }),\r\n  validations: {\r\n    name: {\r\n      required\r\n    },\r\n    currency: {\r\n      required\r\n    },\r\n    password: {\r\n      minLength: minLength(6)\r\n    }\r\n  },\r\n  async mounted() {\r\n    this.newEmail = await this.$store.dispatch('fetchEmail')\r\n    this.currencies = ['UAH', 'USD', 'EUR']\r\n    this.name = this.info.name\r\n    this.currency = this.info.currency\r\n    this.isUaLocale = this.info.locale === 'uk_UA'\r\n    setTimeout(() => {\r\n      this.select = M.FormSelect.init(this.$refs.select);\r\n      M.updateTextFields()\r\n    }, 0)\r\n  },\r\n  computed: {\r\n    ...mapGetters(['info'])\r\n  },\r\n  methods: {\r\n    localizeFilter,\r\n    ...mapActions(['updateInfo', 'fetchEmail', 'updateEmail', 'fetchAllUsers', 'updatePassword']),\r\n\r\n    handleSubmitChangePassword() {\r\n\r\n    },\r\n\r\n    async inputContext() {\r\n      this.changedEmailAndPassword = await this.fetchEmail() !== this.newEmail;\r\n    },\r\n\r\n    inputContextPass() {\r\n      this.changedEmailAndPassword = this.password.length >= 6\r\n      console.log(this.changedEmailAndPassword)\r\n    },\r\n\r\n    async handleSubmit() {\r\n      if (this.v$.$invalid) {\r\n        this.v$.$touch()\r\n        return\r\n      }\r\n      const formData = {\r\n        name: this.name,\r\n        currency: this.currency,\r\n        locale: this.isUaLocale ? 'uk_UA' : 'en_US',\r\n      }\r\n      try {\r\n        const emailExists = (await this.fetchAllUsers()).find(user =>\r\n            user.info.email === this.newEmail\r\n        )\r\n        const data = {\r\n          email: this.newEmail,\r\n          router: this.$router,\r\n          pass: this.pass\r\n        }\r\n        const passwordData = {\r\n          router: this.$router,\r\n          oldPass: this.pass,\r\n          newPass: this.password\r\n        }\r\n\r\n        if (this.password.length >= 6) {\r\n          await this.checkNewPassword(passwordData)\r\n        }\r\n\r\n        if (await this.fetchEmail() !== this.newEmail) {\r\n\r\n          if (emailExists) {\r\n            M.toast({html: localizeFilter.localizeFilter('This email already exists')})\r\n            return\r\n          }\r\n\r\n          await this.updateEmail(data)\r\n        }\r\n        await this.updateInfo(formData)\r\n\r\n      } catch (e) {\r\n        console.log(e)\r\n      }\r\n    },\r\n    async checkNewPassword(passwordData) {\r\n      await this.updatePassword(passwordData)\r\n      this.password = ''\r\n      this.pass = ''\r\n      this.changedEmailAndPassword = false\r\n\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n\r\n<style scoped lang=\"scss\">\r\n.switch {\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.label-pass {\r\n  color: red;\r\n}\r\n\r\n</style>","import { render } from \"./Profile.vue?vue&type=template&id=7236ba9e&scoped=true\"\nimport script from \"./Profile.vue?vue&type=script&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&lang=js\"\n\nimport \"./Profile.vue?vue&type=style&index=0&id=7236ba9e&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7236ba9e\"]])\n\nexport default __exports__"],"names":["class","for","_createElementVNode","type","_createElementBlock","_hoisted_1","_toDisplayString","_ctx","$filters","localize","localizeFilter","onSubmit","_cache","_withModifiers","args","$options","handleSubmit","_hoisted_2","id","name","$event","_normalizeClass","invalid","v$","$dirty","required","$invalid","_hoisted_3","_hoisted_4","_hoisted_5","newEmail","onInput","inputContext","_hoisted_6","_hoisted_7","inputContextPass","password","minLength","_hoisted_8","_hoisted_9","$params","min","length","changedEmailAndPassword","_hoisted_10","pass","_hoisted_11","_hoisted_12","ref","currency","_Fragment","_renderList","currencies","c","idx","key","value","_hoisted_13","_hoisted_14","_hoisted_15","isUaLocale","_hoisted_16","_hoisted_17","_hoisted_18","setup","useHead","title","computed","useVuelidate","data","select","checkboxButton","validations","mounted","this","$store","dispatch","info","locale","setTimeout","M","FormSelect","init","$refs","updateTextFields","mapGetters","methods","mapActions","handleSubmitChangePassword","fetchEmail","console","log","$touch","formData","emailExists","fetchAllUsers","find","user","email","router","$router","passwordData","oldPass","newPass","checkNewPassword","toast","html","updateEmail","updateInfo","e","updatePassword","__exports__","render"],"sourceRoot":""}