"use strict";(self["webpackChunkcrm"]=self["webpackChunkcrm"]||[]).push([[408],{4408:function(e,a,i){i.r(a),i.d(a,{default:function(){return D}});var s=i(3396),l=i(7139),t=i(9242);const n=e=>((0,s.dD)("data-v-7236ba9e"),e=e(),(0,s.Cn)(),e),r={class:"page-title"},o={class:"input-field"},c={for:"name"},d={key:0,class:"helper-text invalid"},u={class:"input-field"},h={for:"email"},w={class:"input-field"},p={for:"password"},m={key:0,class:"helper-text invalid"},f={key:0,class:"input-field"},v={class:"label-pass",for:"pass"},$={class:"input-field"},y=["value"],z={for:"select"},_={class:"switch"},g=n((()=>(0,s._)("span",{class:"lever"},null,-1))),E={class:"btn waves-effect waves-light",type:"submit"},b=n((()=>(0,s._)("i",{class:"material-icons right"},"send",-1)));function U(e,a,i,n,U,k){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",r,[(0,s._)("h3",null,(0,l.zw)(e.$filters.localize.localizeFilter("Profile")),1)]),(0,s._)("form",{class:"form",onSubmit:a[8]||(a[8]=(0,t.iM)(((...e)=>k.handleSubmit&&k.handleSubmit(...e)),["prevent"]))},[(0,s._)("div",o,[(0,s.wy)((0,s._)("input",{id:"name",type:"text","onUpdate:modelValue":a[0]||(a[0]=a=>e.name=a),class:(0,l.C_)({invalid:e.v$.name.$dirty&&e.v$.name.required.$invalid})},null,2),[[t.nr,e.name]]),(0,s._)("label",c,(0,l.zw)(e.$filters.localize.localizeFilter("Name")),1),e.v$.name.$dirty&&e.v$.name.required.$invalid?((0,s.wg)(),(0,s.iD)("span",d,(0,l.zw)(e.$filters.localize.localizeFilter("Enter your name")),1)):(0,s.kq)("",!0)]),(0,s._)("div",u,[(0,s.wy)((0,s._)("input",{id:"email",type:"text","onUpdate:modelValue":a[1]||(a[1]=a=>e.newEmail=a),onInput:a[2]||(a[2]=(...e)=>k.inputContext&&k.inputContext(...e))},null,544),[[t.nr,e.newEmail]]),(0,s._)("label",h,(0,l.zw)(e.$filters.localize.localizeFilter("Change Email")),1)]),(0,s._)("div",w,[(0,s.wy)((0,s._)("input",{onInput:a[3]||(a[3]=(...e)=>k.inputContextPass&&k.inputContextPass(...e)),id:"password",type:"password","onUpdate:modelValue":a[4]||(a[4]=a=>e.password=a),class:(0,l.C_)({invalid:e.v$.password.$dirty&&e.v$.password.minLength.$invalid})},null,34),[[t.nr,e.password,void 0,{trim:!0}]]),(0,s._)("label",p,(0,l.zw)(e.$filters.localize.localizeFilter("Enter new password")),1),e.v$.password.$dirty&&e.v$.password.minLength.$invalid?((0,s.wg)(),(0,s.iD)("small",m,(0,l.zw)(e.$filters.localize.localizeFilter("The password must be"))+" "+(0,l.zw)(e.v$.password.minLength.$params.min)+" "+(0,l.zw)(e.$filters.localize.localizeFilter("characters. Now he"))+" "+(0,l.zw)(e.password.length),1)):(0,s.kq)("",!0)]),e.changedEmailAndPassword?((0,s.wg)(),(0,s.iD)("div",f,[(0,s.wy)((0,s._)("input",{id:"pass",type:"text","onUpdate:modelValue":a[5]||(a[5]=a=>e.pass=a)},null,512),[[t.nr,e.pass]]),(0,s._)("label",v,(0,l.zw)(e.$filters.localize.localizeFilter("Enter password for change Email or Password")),1)])):(0,s.kq)("",!0),(0,s._)("div",$,[(0,s.wy)((0,s._)("select",{ref:"select","onUpdate:modelValue":a[6]||(a[6]=a=>e.currency=a)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.currencies,((e,a)=>((0,s.wg)(),(0,s.iD)("option",{key:a,value:e},(0,l.zw)(e),9,y)))),128))],512),[[t.bM,e.currency]]),(0,s._)("label",z,(0,l.zw)(e.$filters.localize.localizeFilter("Select a currency")),1)]),(0,s._)("div",_,[(0,s._)("label",null,[(0,s.Uk)(" English "),(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":a[7]||(a[7]=a=>e.isUaLocale=a)},null,512),[[t.e8,e.isUaLocale]]),g,(0,s.Uk)(" Українська ")])]),(0,s._)("button",E,[(0,s.Uk)((0,l.zw)(e.$filters.localize.localizeFilter("Update"))+" ",1),b])],32)])}var k=i(65),P=i(5420),F=i(4219),x=i(2524),C=i(6530),A={setup:()=>((0,C.u)({title:(0,s.Fl)((()=>x.Z.localizeFilter("Profile")))}),{v$:(0,F.Xw)()}),data:()=>({select:null,name:"",currency:null,isUaLocale:!0,currencies:[],newEmail:"",pass:"",changedEmailAndPassword:!1,checkboxButton:!1,password:""}),validations:{name:{required:P.C1},currency:{required:P.C1},password:{minLength:(0,P.Ei)(6)}},async mounted(){this.newEmail=await this.$store.dispatch("fetchEmail"),this.currencies=["UAH","USD","EUR"],this.name=this.info.name,this.currency=this.info.currency,this.isUaLocale="uk_UA"===this.info.locale,setTimeout((()=>{this.select=M.FormSelect.init(this.$refs.select),M.updateTextFields()}),0)},computed:{...(0,k.Se)(["info"])},methods:{localizeFilter:x.Z,...(0,k.nv)(["updateInfo","fetchEmail","updateEmail","fetchAllUsers","updatePassword"]),handleSubmitChangePassword(){},async inputContext(){this.changedEmailAndPassword=await this.fetchEmail()!==this.newEmail},inputContextPass(){this.changedEmailAndPassword=this.password.length>=6,console.log(this.changedEmailAndPassword)},async handleSubmit(){if(this.v$.$invalid)return void this.v$.$touch();const e={name:this.name,currency:this.currency,locale:this.isUaLocale?"uk_UA":"en_US"};try{const a=(await this.fetchAllUsers()).find((e=>e.info.email===this.newEmail)),i={email:this.newEmail,router:this.$router,pass:this.pass},s={router:this.$router,oldPass:this.pass,newPass:this.password};if(this.password.length>=6&&await this.checkNewPassword(s),await this.fetchEmail()!==this.newEmail){if(a)return void M.toast({html:x.Z.localizeFilter("This email already exists")});await this.updateEmail(i)}await this.updateInfo(e)}catch(a){console.log(a)}},async checkNewPassword(e){await this.updatePassword(e),this.password="",this.pass="",this.changedEmailAndPassword=!1}}},S=i(89);const L=(0,S.Z)(A,[["render",U],["__scopeId","data-v-7236ba9e"]]);var D=L}}]);
//# sourceMappingURL=408.5e114536.js.map