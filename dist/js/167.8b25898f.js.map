{"version":3,"file":"js/167.8b25898f.js","mappings":"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","sources":["webpack://crm/./src/views/Profile.vue","webpack://crm/./src/views/Profile.vue?24e8"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"page-title\">\r\n      <h3>{{ $filters.localize.localizeFilter('Profile') }}</h3>\r\n    </div>\r\n\r\n    <form class=\"form\" @submit.prevent=\"handleSubmit\">\r\n      <div>\r\n        <i class=\"large material-icons\" v-if=\"!previewImage\">face</i>\r\n        <img :src=\"previewImage\" class=\"uploading-image\"  alt=\"uploading-image\" v-else/>\r\n        <input type=\"file\" accept=\"image/*\" @change=uploadImage($event) id=\"file-input\">\r\n      </div>\r\n      <div class=\"input-field\">\r\n        <input\r\n            id=\"name\"\r\n            type=\"text\"\r\n            v-model=\"name\"\r\n            :class=\"{invalid: (v$.name.$dirty && v$.name.required.$invalid)}\"\r\n        >\r\n        <label for=\"name\">{{ $filters.localize.localizeFilter('Name') }}</label>\r\n        <span\r\n            class=\"helper-text invalid\"\r\n            v-if=\"v$.name.$dirty && v$.name.required.$invalid\">{{ $filters.localize.localizeFilter('Enter your name') }}</span>\r\n      </div>\r\n      <div class=\"input-field\">\r\n        <input\r\n            id=\"email\"\r\n            type=\"text\"\r\n            v-model=\"newEmail\"\r\n            @input=\"inputContext\"\r\n        >\r\n        <label for=\"email\">{{ $filters.localize.localizeFilter('Change Email') }}</label>\r\n      </div>\r\n      <div class=\"input-field\">\r\n        <input\r\n            @input=\"inputContextPass\"\r\n            id=\"password\"\r\n            type=\"password\"\r\n            v-model.trim=\"password\"\r\n            :class=\"{invalid: (v$.password.$dirty && v$.password.minLength.$invalid)}\"\r\n        >\r\n        <label for=\"password\">{{$filters.localize.localizeFilter('Enter new password')}}</label>\r\n        <small\r\n            class=\"helper-text invalid\"\r\n            v-if=\"v$.password.$dirty && v$.password.minLength.$invalid\"\r\n        >\r\n          {{$filters.localize.localizeFilter('The password must be')}} {{v$.password.minLength.$params.min}} {{$filters.localize.localizeFilter('characters. Now he')}} {{password.length}}\r\n        </small>\r\n      </div>\r\n      <div class=\"input-field\" v-if=\"changedEmailAndPassword\">\r\n        <input\r\n            id=\"pass\"\r\n            type=\"text\"\r\n            v-model=\"pass\"\r\n        >\r\n        <label class=\"label-pass\"\r\n               for=\"pass\">{{ $filters.localize.localizeFilter('Enter password for change Email or Password') }}</label>\r\n      </div>\r\n      <div class=\"input-field\">\r\n        <select ref=\"select\" v-model=\"currency\">\r\n          <option\r\n              v-for=\"(c, idx) in currencies\"\r\n              :key=\"idx\"\r\n              :value=\"c\"\r\n          >\r\n            {{ c }}\r\n          </option>\r\n        </select>\r\n        <label for=\"select\">{{ $filters.localize.localizeFilter('Select a currency') }}</label>\r\n      </div>\r\n      <div class=\"switch\">\r\n        <label>\r\n          English\r\n          <input type=\"checkbox\" v-model=\"isUaLocale\">\r\n          <span class=\"lever\"></span>\r\n          Українська\r\n        </label>\r\n      </div>\r\n\r\n      <button class=\"btn waves-effect waves-light\" type=\"submit\">\r\n        {{ $filters.localize.localizeFilter('Update') }}\r\n        <i class=\"material-icons right\">send</i>\r\n      </button>\r\n    </form>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {mapGetters, mapActions} from 'vuex'\r\nimport {required, minLength} from '@vuelidate/validators'\r\nimport {useVuelidate} from \"@vuelidate/core\";\r\nimport localizeFilter from \"@/filter/localize.filter\";\r\nimport {computed} from \"vue\";\r\nimport {useHead} from \"@vueuse/head\";\r\nexport default {\r\n  setup: () => (\r\n      useHead({\r\n        title: computed(() => localizeFilter.localizeFilter('Profile'))\r\n      }),\r\n          {\r\n            v$: useVuelidate()\r\n          }\r\n  ),\r\n  data: () => ({\r\n    select: null,\r\n    name: '',\r\n    currency: null,\r\n    isUaLocale: true,\r\n    currencies: [],\r\n    newEmail: '',\r\n    pass: '',\r\n    changedEmailAndPassword: false,\r\n    checkboxButton: false,\r\n    password: '',\r\n    previewImage: null,\r\n  }),\r\n  validations: {\r\n    name: {\r\n      required\r\n    },\r\n    currency: {\r\n      required\r\n    },\r\n    password: {\r\n      minLength: minLength(6)\r\n    }\r\n  },\r\n  async mounted() {\r\n    if (this.$store.getters.info.image) {\r\n    this.previewImage = this.$store.getters.info.image\r\n    }\r\n    this.newEmail = await this.$store.dispatch('fetchEmail')\r\n    this.currencies = ['UAH', 'USD', 'EUR']\r\n    this.name = this.info.name\r\n    this.currency = this.info.currency\r\n    this.isUaLocale = this.info.locale === 'uk_UA'\r\n    setTimeout(() => {\r\n      this.select = M.FormSelect.init(this.$refs.select);\r\n      M.updateTextFields()\r\n    }, 0)\r\n  },\r\n  computed: {\r\n    ...mapGetters(['info'])\r\n  },\r\n  methods: {\r\n    localizeFilter,\r\n    ...mapActions(['updateInfo', 'fetchEmail', 'updateEmail', 'fetchAllUsers', 'updatePassword']),\r\n\r\n    async inputContext() {\r\n      this.changedEmailAndPassword = await this.fetchEmail() !== this.newEmail;\r\n    },\r\n\r\n    inputContextPass() {\r\n      this.changedEmailAndPassword = this.password.length >= 6\r\n      console.log(this.changedEmailAndPassword)\r\n    },\r\n\r\n    async handleSubmit() {\r\n      if (this.v$.$invalid) {\r\n        this.v$.$touch()\r\n        return\r\n      }\r\n      const formData = {\r\n        name: this.name,\r\n        currency: this.currency,\r\n        locale: this.isUaLocale ? 'uk_UA' : 'en_US',\r\n        image: this.previewImage\r\n      }\r\n      try {\r\n        const emailExists = (await this.fetchAllUsers()).find(user =>\r\n            user.info.email === this.newEmail\r\n        )\r\n        const data = {\r\n          email: this.newEmail,\r\n          router: this.$router,\r\n          pass: this.pass\r\n        }\r\n        const passwordData = {\r\n          router: this.$router,\r\n          oldPass: this.pass,\r\n          newPass: this.password\r\n        }\r\n\r\n        if (this.password.length >= 6) {\r\n          await this.checkNewPassword(passwordData)\r\n        }\r\n\r\n        // For Upload image in Firebase Storage\r\n\r\n        // const file = e.target[0].files[0]\r\n        // const storage = getStorage();\r\n        // const storageRef = ref(storage, 'image/' + e.timeStamp + file.name);\r\n        //\r\n        // await uploadBytes(storageRef, file)\r\n\r\n\r\n        if (await this.fetchEmail() !== this.newEmail) {\r\n\r\n          if (emailExists) {\r\n            M.toast({html: localizeFilter.localizeFilter('This email already exists')})\r\n            return\r\n          }\r\n\r\n          await this.updateEmail(data)\r\n        }\r\n        await this.updateInfo(formData)\r\n\r\n      } catch (e) {\r\n        console.log(e)\r\n      }\r\n    },\r\n    async checkNewPassword(passwordData) {\r\n      await this.updatePassword(passwordData)\r\n      this.password = ''\r\n      this.pass = ''\r\n      this.changedEmailAndPassword = false\r\n\r\n    },\r\n    uploadImage(e){\r\n      const image = e.target.files[0];\r\n      const reader = new FileReader();\r\n      console.log(e)\r\n      reader.readAsDataURL(image);\r\n      reader.onload = e =>{\r\n        this.previewImage = e.target.result;\r\n      };\r\n\r\n\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n\r\n<style scoped lang=\"scss\">\r\n.switch {\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.label-pass {\r\n  color: red;\r\n}\r\n.uploading-image {\r\n  max-width: 250px;\r\n  max-height: 250px;\r\n}\r\n\r\n</style>","import { render } from \"./Profile.vue?vue&type=template&id=7bf5196a&scoped=true\"\nimport script from \"./Profile.vue?vue&type=script&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&lang=js\"\n\nimport \"./Profile.vue?vue&type=style&index=0&id=7bf5196a&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7bf5196a\"]])\n\nexport default __exports__"],"names":["class","for","_createElementVNode","type","_createElementBlock","_hoisted_1","_toDisplayString","_ctx","$filters","localize","localizeFilter","onSubmit","_cache","_withModifiers","args","$options","handleSubmit","previewImage","src","alt","_hoisted_2","accept","onChange","$event","uploadImage","id","_hoisted_4","name","_normalizeClass","invalid","v$","$dirty","required","$invalid","_hoisted_5","_hoisted_6","_hoisted_7","newEmail","onInput","inputContext","_hoisted_8","_hoisted_9","inputContextPass","password","minLength","_hoisted_10","_hoisted_11","$params","min","length","changedEmailAndPassword","_hoisted_12","pass","_hoisted_13","_hoisted_14","ref","currency","_Fragment","_renderList","currencies","c","idx","key","value","_hoisted_15","_hoisted_16","_hoisted_17","isUaLocale","_hoisted_18","_hoisted_19","_hoisted_20","setup","useHead","title","computed","useVuelidate","data","select","checkboxButton","validations","mounted","this","$store","getters","info","image","dispatch","locale","setTimeout","M","FormSelect","init","$refs","updateTextFields","mapGetters","methods","mapActions","fetchEmail","console","log","$touch","formData","emailExists","fetchAllUsers","find","user","email","router","$router","passwordData","oldPass","newPass","checkNewPassword","toast","html","updateEmail","updateInfo","e","updatePassword","target","files","reader","FileReader","readAsDataURL","onload","result","__exports__","render"],"sourceRoot":""}