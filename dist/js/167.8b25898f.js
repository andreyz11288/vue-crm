"use strict";(self["webpackChunkcrm"]=self["webpackChunkcrm"]||[]).push([[167],{9167:function(e,i,a){a.r(i),a.d(i,{default:function(){return q}});var l=a(3396),s=a(7139),t=a(9242);const n=e=>((0,l.dD)("data-v-7bf5196a"),e=e(),(0,l.Cn)(),e),r={class:"page-title"},o={key:0,class:"large material-icons"},c=["src"],d={class:"input-field"},u={for:"name"},p={key:0,class:"helper-text invalid"},h={class:"input-field"},w={for:"email"},m={class:"input-field"},f={for:"password"},g={key:0,class:"helper-text invalid"},v={key:0,class:"input-field"},y={class:"label-pass",for:"pass"},$={class:"input-field"},z=["value"],_={for:"select"},E={class:"switch"},U=n((()=>(0,l._)("span",{class:"lever"},null,-1))),b={class:"btn waves-effect waves-light",type:"submit"},k=n((()=>(0,l._)("i",{class:"material-icons right"},"send",-1)));function P(e,i,a,n,P,F){return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",r,[(0,l._)("h3",null,(0,s.zw)(e.$filters.localize.localizeFilter("Profile")),1)]),(0,l._)("form",{class:"form",onSubmit:i[9]||(i[9]=(0,t.iM)(((...e)=>F.handleSubmit&&F.handleSubmit(...e)),["prevent"]))},[(0,l._)("div",null,[e.previewImage?((0,l.wg)(),(0,l.iD)("img",{key:1,src:e.previewImage,class:"uploading-image",alt:"uploading-image"},null,8,c)):((0,l.wg)(),(0,l.iD)("i",o,"face")),(0,l._)("input",{type:"file",accept:"image/*",onChange:i[0]||(i[0]=e=>F.uploadImage(e)),id:"file-input"},null,32)]),(0,l._)("div",d,[(0,l.wy)((0,l._)("input",{id:"name",type:"text","onUpdate:modelValue":i[1]||(i[1]=i=>e.name=i),class:(0,s.C_)({invalid:e.v$.name.$dirty&&e.v$.name.required.$invalid})},null,2),[[t.nr,e.name]]),(0,l._)("label",u,(0,s.zw)(e.$filters.localize.localizeFilter("Name")),1),e.v$.name.$dirty&&e.v$.name.required.$invalid?((0,l.wg)(),(0,l.iD)("span",p,(0,s.zw)(e.$filters.localize.localizeFilter("Enter your name")),1)):(0,l.kq)("",!0)]),(0,l._)("div",h,[(0,l.wy)((0,l._)("input",{id:"email",type:"text","onUpdate:modelValue":i[2]||(i[2]=i=>e.newEmail=i),onInput:i[3]||(i[3]=(...e)=>F.inputContext&&F.inputContext(...e))},null,544),[[t.nr,e.newEmail]]),(0,l._)("label",w,(0,s.zw)(e.$filters.localize.localizeFilter("Change Email")),1)]),(0,l._)("div",m,[(0,l.wy)((0,l._)("input",{onInput:i[4]||(i[4]=(...e)=>F.inputContextPass&&F.inputContextPass(...e)),id:"password",type:"password","onUpdate:modelValue":i[5]||(i[5]=i=>e.password=i),class:(0,s.C_)({invalid:e.v$.password.$dirty&&e.v$.password.minLength.$invalid})},null,34),[[t.nr,e.password,void 0,{trim:!0}]]),(0,l._)("label",f,(0,s.zw)(e.$filters.localize.localizeFilter("Enter new password")),1),e.v$.password.$dirty&&e.v$.password.minLength.$invalid?((0,l.wg)(),(0,l.iD)("small",g,(0,s.zw)(e.$filters.localize.localizeFilter("The password must be"))+" "+(0,s.zw)(e.v$.password.minLength.$params.min)+" "+(0,s.zw)(e.$filters.localize.localizeFilter("characters. Now he"))+" "+(0,s.zw)(e.password.length),1)):(0,l.kq)("",!0)]),e.changedEmailAndPassword?((0,l.wg)(),(0,l.iD)("div",v,[(0,l.wy)((0,l._)("input",{id:"pass",type:"text","onUpdate:modelValue":i[6]||(i[6]=i=>e.pass=i)},null,512),[[t.nr,e.pass]]),(0,l._)("label",y,(0,s.zw)(e.$filters.localize.localizeFilter("Enter password for change Email or Password")),1)])):(0,l.kq)("",!0),(0,l._)("div",$,[(0,l.wy)((0,l._)("select",{ref:"select","onUpdate:modelValue":i[7]||(i[7]=i=>e.currency=i)},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.currencies,((e,i)=>((0,l.wg)(),(0,l.iD)("option",{key:i,value:e},(0,s.zw)(e),9,z)))),128))],512),[[t.bM,e.currency]]),(0,l._)("label",_,(0,s.zw)(e.$filters.localize.localizeFilter("Select a currency")),1)]),(0,l._)("div",E,[(0,l._)("label",null,[(0,l.Uk)(" English "),(0,l.wy)((0,l._)("input",{type:"checkbox","onUpdate:modelValue":i[8]||(i[8]=i=>e.isUaLocale=i)},null,512),[[t.e8,e.isUaLocale]]),U,(0,l.Uk)(" Українська ")])]),(0,l._)("button",b,[(0,l.Uk)((0,s.zw)(e.$filters.localize.localizeFilter("Update"))+" ",1),k])],32)])}var F=a(65),x=a(5420),C=a(4219),I=a(2524),A=a(6530),D={setup:()=>((0,A.u)({title:(0,l.Fl)((()=>I.Z.localizeFilter("Profile")))}),{v$:(0,C.Xw)()}),data:()=>({select:null,name:"",currency:null,isUaLocale:!0,currencies:[],newEmail:"",pass:"",changedEmailAndPassword:!1,checkboxButton:!1,password:"",previewImage:null}),validations:{name:{required:x.C1},currency:{required:x.C1},password:{minLength:(0,x.Ei)(6)}},async mounted(){this.$store.getters.info.image&&(this.previewImage=this.$store.getters.info.image),this.newEmail=await this.$store.dispatch("fetchEmail"),this.currencies=["UAH","USD","EUR"],this.name=this.info.name,this.currency=this.info.currency,this.isUaLocale="uk_UA"===this.info.locale,setTimeout((()=>{this.select=M.FormSelect.init(this.$refs.select),M.updateTextFields()}),0)},computed:{...(0,F.Se)(["info"])},methods:{localizeFilter:I.Z,...(0,F.nv)(["updateInfo","fetchEmail","updateEmail","fetchAllUsers","updatePassword"]),async inputContext(){this.changedEmailAndPassword=await this.fetchEmail()!==this.newEmail},inputContextPass(){this.changedEmailAndPassword=this.password.length>=6,console.log(this.changedEmailAndPassword)},async handleSubmit(){if(this.v$.$invalid)return void this.v$.$touch();const e={name:this.name,currency:this.currency,locale:this.isUaLocale?"uk_UA":"en_US",image:this.previewImage};try{const i=(await this.fetchAllUsers()).find((e=>e.info.email===this.newEmail)),a={email:this.newEmail,router:this.$router,pass:this.pass},l={router:this.$router,oldPass:this.pass,newPass:this.password};if(this.password.length>=6&&await this.checkNewPassword(l),await this.fetchEmail()!==this.newEmail){if(i)return void M.toast({html:I.Z.localizeFilter("This email already exists")});await this.updateEmail(a)}await this.updateInfo(e)}catch(i){console.log(i)}},async checkNewPassword(e){await this.updatePassword(e),this.password="",this.pass="",this.changedEmailAndPassword=!1},uploadImage(e){const i=e.target.files[0],a=new FileReader;console.log(e),a.readAsDataURL(i),a.onload=e=>{this.previewImage=e.target.result}}}},L=a(89);const S=(0,L.Z)(D,[["render",P],["__scopeId","data-v-7bf5196a"]]);var q=S}}]);
//# sourceMappingURL=167.8b25898f.js.map